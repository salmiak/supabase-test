import{g as h,r as d,l as k,c as o,a as t,i as f,F as _,j as C,w as v,v as c,x as V,s as a,t as w,o as s}from"./index-gws9AHgW.js";import{_ as x}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A={key:0},L={key:1},N={key:0},U=["href"],q=["onClick"],E={key:0},F=h({__name:"DishListView",setup(B){const n=d([]),p=d(!0),u=d(!1),r=d({title:"",description:"",recipe_url:""}),D=async()=>{p.value=!0;const{data:l,error:e}=await a.from("dishes").select("id, title, description, recipe_url");e?console.error("Error fetching dishes:",e):n.value=l,p.value=!1},b=async()=>{const{data:{user:l}}=await a.auth.getUser(),{data:e,error:i}=await a.from("profiles").select("family_id").eq("id",l==null?void 0:l.id).single();if(i||!e){console.error("Could not get family_id",i);return}const{data:m,error:y}=await a.from("dishes").insert({...r.value,family_id:e.family_id}).select("id, title, description, recipe_url").single();if(y){console.error("Error adding dish:",y);return}await n.value.push(m),r.value={title:"",description:"",recipe_url:""},u.value=!1},g=async l=>{if(!confirm("Are you sure you want to delete this dish?"))return;const{error:e}=await a.from("dishes").delete().eq("id",l);if(e){console.error("Failed to delete dish:",e);return}n.value=n.value.filter(i=>i.id!==l)};return k(D),(l,e)=>(s(),o(_,null,[t("div",null,[e[5]||(e[5]=t("h1",null,[t("span",null,"Alla recept")],-1)),p.value?(s(),o("div",A,"Loading dishes...")):(s(),o("div",L,[n.value.length===0?(s(),o("div",N,"No dishes found.")):f("",!0),t("ul",null,[(s(!0),o(_,null,C(n.value,i=>(s(),o("li",{key:i.id},[t("h2",null,w(i.title),1),t("p",null,w(i.description),1),i.recipe_url?(s(),o("a",{key:0,href:i.recipe_url,target:"_blank"},"View Recipe",8,U)):f("",!0),t("button",{onClick:m=>g(i.id)},"ðŸ—‘ Delete",8,q)]))),128))])]))]),t("button",{onClick:e[0]||(e[0]=i=>u.value=!0)},"Add New Dish"),u.value?(s(),o("div",E,[e[10]||(e[10]=t("h2",null,"Add a New Dish",-1)),t("form",{onSubmit:V(b,["prevent"])},[t("div",null,[e[6]||(e[6]=t("label",{for:"title"},"Title",-1)),v(t("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>r.value.title=i),id:"title",type:"text",required:""},null,512),[[c,r.value.title]])]),t("div",null,[e[7]||(e[7]=t("label",{for:"description"},"Description",-1)),v(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=i=>r.value.description=i),id:"description",required:""},null,512),[[c,r.value.description]])]),t("div",null,[e[8]||(e[8]=t("label",{for:"recipe_url"},"Recipe URL",-1)),v(t("input",{"onUpdate:modelValue":e[3]||(e[3]=i=>r.value.recipe_url=i),id:"recipe_url",type:"url"},null,512),[[c,r.value.recipe_url]])]),e[9]||(e[9]=t("button",{type:"submit"},"Save Dish",-1)),t("button",{type:"button",onClick:e[4]||(e[4]=i=>u.value=!1)}," Cancel ")],32)])):f("",!0)],64))}}),S=x(F,[["__scopeId","data-v-e2b2c31a"]]);export{S as default};
